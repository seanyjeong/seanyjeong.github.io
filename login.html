<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ë¡œê·¸ì¸ - MaxFeed</title>
  <link href="https://cdn.jsdelivr.net/npm/water.css@2/out/light.min.css" rel="stylesheet">
</head>
<body>

<h2>ë¡œê·¸ì¸</h2>
<input type="text" id="username" placeholder="ì•„ì´ë””">
<input type="password" id="password" placeholder="ë¹„ë°€ë²ˆí˜¸">
<button onclick="login()">ë¡œê·¸ì¸</button>
<button onclick="location.href='register.html'">íšŒì›ê°€ì…</button>

<script>
const api = 'https://supermax.kr/feed';

async function login() {
  const res = await fetch(`${api}/login`, {
    method: 'POST',
    headers: { 'Content-Type': 'application/json' },
    body: JSON.stringify({
      username: document.getElementById('username').value,
      password: document.getElementById('password').value
    })
  });

  const data = await res.json();

  if (res.ok) {
    // âœ… ì—¬ê¸° ì•ˆì´ ë¡œê·¸ì¸ ì„±ê³µ ì²˜ë¦¬ ë¶€ë¶„ì´ì•¼!
    // ğŸ‘‡ ì—¬ê¸°ì— ì´ê±° ë„£ìœ¼ë©´ ë¨:

    localStorage.setItem('token', data.token);
    localStorage.setItem('user_id', String(data.user_id));

    alert('ë¡œê·¸ì¸ ì„±ê³µ!');

    const redirectTo = localStorage.getItem("redirect_after_login") || 'index.html';
    localStorage.removeItem("redirect_after_login");
    location.href = redirectTo;

  } else {
    alert('ë¡œê·¸ì¸ ì‹¤íŒ¨');
  }
}

</script>

</body>
</html>